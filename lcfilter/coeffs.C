#include <stdio.h>
#include <string.h>

#include "lcfilter.h"

/* triangular arrays */

#define TABSIZE tabindex(MAXORDER+1)	/* size of triangular arrays */

static float butter[TABSIZE] =
  { /* Butterworth */
    1.000,
    2.000,  1.000,
    1.414,  1.414,  1.000,
    1.000,  2.000,  1.000,  1.000,
    0.7654, 1.848,  1.848,  0.7654, 1.000,
    0.6180, 1.618,  2.000,  1.618,  0.6180, 1.000,
    0.5176, 1.414,  1.932,  1.932,  1.414,  0.5176, 1.000,
    0.4450, 1.247,  1.802,  2.000,  1.802,  1.247,  0.4450, 1.000,
    0.3902, 1.111,  1.663,  1.962,  1.962,  1.663,  1.111,  0.3902, 1.000,
    0.3473, 1.000,  1.532,  1.879,  2.000,  1.879,  1.532,  1.000,  0.3473, 1.000,
    0.3129, 0.9080, 1.414,  1.782,  1.975,  1.975,  1.782,  1.414,  0.9080, 0.3129, 1.000,
  };

static float cheb1[TABSIZE] =
  { /* Chebyshev, 0.01dB ripple */
    1.1007,
    0.0960, 1.0000,
    0.4488, 0.4077, 1.1007,
    0.6291, 0.9702, 0.6291, 1.0000,
    0.7128, 1.2003, 1.3212, 0.6476, 1.1007,
    0.7563, 1.3049, 1.5773, 1.3049, 0.7563, 1.0000,
    0.7813, 1.3600, 1.6896, 1.5350, 1.4970, 0.7098, 1.1007,
    0.7969, 1.3924, 1.7481, 1.6331, 1.7481, 1.3924, 0.7969, 1.0000,
    0.8072, 1.4130, 1.7824, 1.6833, 1.8529, 1.6193, 1.5554, 0.7333, 1.1007,
    0.8144, 1.4270, 1.8043, 1.7125, 1.9057, 1.7125, 1.8043, 1.4270, 0.8144, 1.0000,
    0.8196, 1.4369, 1.8192, 1.7311, 1.9362, 1.7590, 1.9055, 1.6527, 1.5817, 0.7446, 1.1007,
  };

static float cheb2[TABSIZE] =
  { /* Chebyshev, 0.1dB ripple */
    1.3554,
    0.3052, 1.0000,
    0.8430, 0.6220, 1.3554,
    1.0315, 1.1474, 1.0315, 1.0000,
    1.1088, 1.3061, 1.7703, 0.8180, 1.3554,
    1.1468, 1.3712, 1.9750, 1.3712, 1.1468, 1.0000,
    1.1681, 1.4039, 2.0562, 1.5170, 1.9029, 0.8618, 1.3554,
    1.1811, 1.4228, 2.0966, 1.5733, 2.0966, 1.4228, 1.1811, 1.0000,
    1.1897, 1.4346, 2.1199, 1.6010, 2.1699, 1.5640, 1.9444, 0.8778, 1.3554,
    1.1956, 1.4425, 2.1345, 1.6167, 2.2053, 1.6167, 2.1345, 1.4425, 1.1956, 1.0000,
    1.1999, 1.4481, 2.1444, 1.6265, 2.2253, 1.6418, 2.2046, 1.5821, 1.9628, 0.8853, 1.3554,
  };

static float cheb3[TABSIZE] =
  { /* Chebyshev, 0.2dB ripple */
    1.5386,
    0.4342, 1.0000,
    1.0378, 0.6745, 1.5386,
    1.2275, 1.1525, 1.2275, 1.0000,
    1.3028, 1.2844, 1.9761, 0.8468, 1.5386,
    1.3394, 1.3370, 2.1660, 1.3370, 1.3394, 1.0000,
    1.3598, 1.3632, 2.2394, 1.4555, 2.0974, 0.8838, 1.5386,
    1.3722, 1.3781, 2.2756, 1.5001, 2.2756, 1.3781, 1.3722, 1.0000,
    1.3804, 1.3875, 2.2963, 1.5217, 2.3413, 1.4925, 2.1349, 0.8972, 1.5386,
    1.3860, 1.3938, 2.3093, 1.5340, 2.3728, 1.5340, 2.3093, 1.3938, 1.3860, 1.0000,
    1.3901, 1.3983, 2.3181, 1.5417, 2.3904, 1.5536, 2.3720, 1.5066, 2.1514, 0.9034, 1.5386,
  };

static float cheb4[TABSIZE] =
  { /* Chebyshev, 1.0dB ripple */
    2.6599,
    1.0177, 1.0000,
    1.8219, 0.6850, 2.6599,
    2.0236, 0.9941, 2.0236, 1.0000,
    2.0991, 1.0644, 2.8311, 0.7892, 2.6599,
    2.1349, 1.0911, 3.0009, 1.0911, 2.1349, 1.0000,
    2.1546, 1.1041, 3.0634, 1.1518, 2.9367, 0.8101, 2.6599,
    2.1664, 1.1116, 3.0934, 1.1736, 3.0934, 1.1116, 2.1664, 1.0000,
    2.1744, 1.1161, 3.1107, 1.1839, 3.1488, 1.1696, 2.9685, 0.8175, 2.6599,
    2.1797, 1.1192, 3.1215, 1.1897, 3.1747, 1.1897, 3.1215, 1.1192, 2.1797, 1.0000,
    2.1836, 1.1213, 3.1286, 1.1933, 3.1890, 1.1990, 3.1738, 1.1763, 2.9824, 0.8210, 2.6599,
  };

static float cheb5[TABSIZE] =
  { /* Chebyshev, 3.0dB ripple */
    5.8095,
    1.9953, 1.0000,
    3.1013, 0.5339, 5.8095,
    3.3487, 0.7117, 3.3487, 1.0000,
    3.4389, 0.7483, 4.3471, 0.5920, 5.8095,
    3.4817, 0.7618, 4.5381, 0.7618, 3.4817, 1.0000,
    3.5045, 0.7685, 4.6061, 0.7929, 4.4641, 0.6033, 5.8095,
    3.5182, 0.7723, 4.6386, 0.8039, 4.6386, 0.7723, 3.5182, 1.0000,
    3.5277, 0.7745, 4.6575, 0.8089, 4.6990, 0.8018, 4.4990, 0.6073, 5.8095,
    3.5340, 0.7760, 4.6692, 0.8118, 4.7272, 0.8118, 4.6692, 0.7760, 3.5340, 1.0000,
    3.5384, 0.7771, 4.6768, 0.8136, 4.7425, 0.8164, 4.7260, 0.8051, 4.5142, 0.6091, 5.8095,
  };

struct FtInfo
  { char *str;
    float *ptr;
  };

static FtInfo ftinfo[] =
  { { "Butterworth", butter },
    { "Cheb/0.01",   cheb1  },
    { "Cheb/0.1",    cheb2  },
    { "Cheb/0.2",    cheb3  },
    { "Cheb/1.0",    cheb4  },
    { "Cheb/3.0",    cheb5  },
    { NULL,	     NULL   },
  };

global float *coeffs(char *s)
  { int k = 0;
    until (ftinfo[k].str == NULL || seq(ftinfo[k].str, s)) k++;
    return ftinfo[k].ptr;
  }

